<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>  
	  
  	OpenGL - 渲染过程 - 
  	
	</title>

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="atom.xml" rel="alternate" title="" type="application/atom+xml">

	<link href="asset/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="asset/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<script src="asset/javascripts/jquery.min.js"></script>
	<script src="asset/highlightjs/highlight.pack.js"></script>
	<link href="asset/highlightjs/styles/solarized_dark.css" media="screen, projection" rel="stylesheet" type="text/css">
<script>hljs.initHighlightingOnLoad();</script>

	<!--[if lt IE 9]><script src="asset/javascripts/html5.js"></script><![endif]-->
	<!-- <link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'> -->
	<style type="text/css">
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 300;
  src: local('Nunito-Light'), url(asset/font/1TiHc9yag0wq3lDO9cw0voX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 400;
  src: local('Nunito-Regular'), url(asset/font/6TbRXKWJjpj6V2v_WyRbMX-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 700;
  src: local('Nunito-Bold'), url(asset/font/TttUCfJ272GBgSKaOaD7KoX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
	</style>
	
	<style type="text/css">
	.container .left-col{ opacity: 1;}
	#pagenavi a{ font-size: 1.3em;}
	#pagenavi .next:before{ top: 3px;}
	#pagenavi .prev:before{ top: 3px;}
	.container .mid-col .mid-col-container #content .archives .title{ font-size: 1.5em;}
	.container .mid-col .mid-col-container #content article{ padding: 15px 0px;}
	#header .subtitle {
		line-height: 1.2em;
		padding-top: 8px;
	}
	article pre{ background: none; border: none; padding: 0;}
	article .entry-content{text-align: left;}
	.share-comment{ padding: 25px 0px; clear: both;}
	hr{ margin: 20px 0px;border: 0; border-top:solid 1px #ddd;}
	</style>
  

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
				<header id="header" class="inner">
				 
					
					<h1><a href="index.html"></a></h1>
					<p class="subtitle"></p>
					<nav id="main-nav">
						<ul class="main">
						
						  <li id=""><a target="_self" href="index.html">Home</a></li>
						
						  <li id=""><a target="_self" href="archives.html">Archives</a></li>
						
						  <li id=""><a target="_blank" href="https://github.com/Caolongs">Alongs</a></li>
						
						</ul>
					</nav>

					<nav id="sub-nav">
						<div class="social">










<a target="_blank" class="github" target="_blank" href="https://github.com/Caolongs" title="GitHub">GitHub</a>


								

								<a class="rss" href="atom.xml" title="RSS">RSS</a>
							
						</div>
					</nav>
				</header>				
			</div>
		</div>	
		<div class="mid-col">
			<div class="mid-col-container"> <div id="content" class="inner">

	<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
		<h1 class="title" itemprop="name">OpenGL - 渲染过程</h1>
		<div class="entry-content" itemprop="articleBody">
			<h2 id="toc_0">一、基本图形硬件流水线设计</h2>

<p><img src="media/15263723434422/15263724067540.jpg" alt=""/><br/>
<mark>应⽤用程序层 -&gt; 硬件抽象层 -&gt; 硬件层</mark></p>

<p><strong>应⽤层</strong>: 游戏和应⽤用层软件开发⼈人员为主体，通过调⽤用API进行上层开发，不需要考虑移植性问题。 <br/>
<strong>硬件抽象层</strong>: 抽象出硬件的加速功能，进行有利于应用层开发的封装，并向应⽤层开发API <br/>
<strong>硬件层</strong>: 将硬件驱动提供给抽象层，以实现抽象层加速功能的有效性。</p>

<h2 id="toc_1">二、渲染流水线的具体流程</h2>

<h3 id="toc_2">1、应⽤层</h3>

<p>应⽤程序层主要与内存，CPU打交道，诸如碰撞检测，场景图监理，视锥裁剪等经典算法在此阶段执行。在阶段的末端，几何体的数据(顶点坐标，法向量，纹理坐标，纹理)等通过数据总线传送到图形硬件</p>

<h3 id="toc_3">2、硬件抽象层</h3>

<p>在这⼀层，我们目前使用的是DirectX与OpenGL。对于这⼀部分，主要是⼀些API等的调⽤</p>

<h3 id="toc_4">3、硬件层</h3>

<p>硬件层在渲染流水线中最为复杂，也最为重要。可编程渲染流水线与固定渲染流水线的区别在于是否对着色器进⾏编程。<br/>
  ⾸先我们先了解固定渲染流水线它主要分为以下几个阶段:<br/>
  顶点变换 -&gt; 图元转配与光栅化 -&gt; ⽚段纹理映射和着色 -&gt; 光栅化操作</p>

<h2 id="toc_5">三、硬件层—固定渲染管线流程图</h2>

<p><img src="media/15263723434422/15263732132633.jpg" alt=""/></p>

<p><strong>光栅化(Rasterization)</strong>:将顶点数据转换为片元的过程! 将具体的图转化为一个个栅格组成的图像的作⽤<br/>
⽚元中每个一个元素对于帧缓存区的一个像素; 光栅化其实是一个将几何图元变成一个二维图像的过程!!<br/>
光栅化的过程就是为了产出⽚元</p>

<h2 id="toc_6">四、硬件层—可编程渲染流水线流程图</h2>

<p><img src="media/15263723434422/15263733597135.jpg" alt=""/></p>

<h2 id="toc_7">五、GPU 图形渲染管线</h2>

<p><img src="media/15263723434422/15263734882629.jpg" alt=""/></p>

<p><strong>应用程序阶段</strong><br/>
主要是⾼级编程语言开发,C,OC,C++ <br/>
输出:通过数据总线,把几何体的数据(顶点坐标\法线\纹理理坐标\纹理理)等传送到GPU上</p>

<p><strong>⼏何阶段</strong><br/>
输入:应⽤程序末端的内容 <br/>
负责任务:顶点坐标变换,光照,裁剪,投影,屏幕映射 <br/>
输出:经过变换和投影之后的屏幕坐标,颜⾊,纹理坐标</p>

<p><strong>光栅化阶段</strong><br/>
见上</p>

<h3 id="toc_8">光栅化操作</h3>

<p>这⼀步我们将会对其进行各种测试，⽽假如它通过了所有的测试，⽚段将会显示在屏幕上<br/>
<img src="media/15263723434422/15263750349578.jpg" alt=""/></p>

<p><strong>抖动显示</strong>:一种能够使用较少的颜色种类模拟较多颜色的显示模式</p>

<h3 id="toc_9">⼏何处理阶段</h3>

<p>几何阶段主要负责大部分多边形操作和顶点操作，包括顶点着色、坐标变换、生成图元、投影、<br/>
 裁剪、屏幕映射等过程，其中顶点着色、坐标变换由顶点着色器完成</p>

<ol>
<li><strong>顶点着⾊器</strong> </li>
<li><strong>⽣成图元</strong>： 顶点数组或索引数组经由顶点着色程序生成三角形的组合</li>
<li><strong>投影</strong>： 透视投影，平行投影</li>
<li><strong>裁切</strong>： 仅保留视景体内部的图元进行渲染</li>
<li><strong>屏幕映射</strong>： 这个阶段是不可配置也不可编程的。主要用来实现图元的坐标转换到屏幕坐标</li>
</ol>

<h2 id="toc_10">六、其他</h2>

<h3 id="toc_11">Shader</h3>

<p><strong>Shader</strong>，中⽂名，着色器。着⾊器其实就是一段在GPU运行的程序。我们平时的程序，是在CPU运行。由于GPU的硬件设计结构与CPU有着很大的不同，所以GPU需要一些新的编程语言</p>

<p>渲染流水线分为两种，其中一种为<strong>可编程渲染流水线</strong>。另外一种为<strong>固定渲染流水线</strong>。(也称可编程管线或固定管线，管线就是流⽔线的意思)。渲染流⽔线可否编程，取决于程序猿能否在顶点着色器以及⽚段着色器上进⾏行编码。⽽现在的渲染流水线，基本都是可编程的，当然，它们也支持固定渲染流水线的功能</p>

<h3 id="toc_12">CPU 与 GPU 之间的关系</h3>

<p>GPU具有⾼并行的结构，所以在处理图形数据和复杂算法比CPU更加有效率</p>

<p><img src="media/15263723434422/15263738384864.jpg" alt=""/></p>

<p>CPU在执行任务的时候，⼀个时刻只会处理⼀个数据，不存在真正意义上的并行，⽽GPU则有多个处理器核，在⼀个时刻可以并行处理多个数据</p>

<h3 id="toc_13">三维坐标转变为二维屏幕坐标的过程</h3>

<p><img src="media/15263723434422/15263754091644.jpg" alt=""/></p>

<p>MC是建模坐标系，WC是世界坐标系，VC是观察坐标系，PC是投影坐标系，NPC是规格化投影坐标系，DC是设备坐标系</p>

<h3 id="toc_14">坐标系详细概念</h3>

<ul>
<li><strong>世界坐标系</strong> 坐标系统主要⽤于计算机图形场景中的所有图形对象的空间定位和定义</li>
<li><strong>局部坐标系</strong> 独立于世界坐标系来定义物体几何特性</li>
<li><strong>观察坐标系</strong> 观察坐标系通常是以视点的位置为原点，通过⽤户指定的一个向上的观察向量来定义整个坐标系统，观察坐标系主要⽤于从观察者的角度对整个世界坐标系内的对象进行重新定位和描述，从而简化⼏何物体在投影面的成像的数学推导和计算</li>
<li><strong>投影坐标系</strong> 物体从世界坐标描述转换到观察坐标后，可将三维物体投影到二维表面上，即投影到虚拟摄像机的胶片上，这个过程就是投影变换。以胶片中心为参考原点的空间坐标系称为投影坐标系，物体在投影坐标系中的坐标称为投影坐标。</li>
<li><strong>设备坐标系</strong> 是图形设备上采用的与具体设备相关的坐标系。设备坐标系一般采⽤用整数坐标，其坐标范围由具体设备的分辨率决定。设备坐标系上的⼀个点一般对应图形设备上的一个像素。由于具体设备的限制，设备坐标系的坐标范围一般是有限的。</li>
<li><strong>规格化设备坐标系</strong> 是为了避免设备相关性而定义的一种虚拟的设备坐标系。规格化坐标系的坐标范围一般从0到1，也有的是从-1到+1。采用规格化设备坐标系的好处是屏蔽了具体设备的分辨率，使得图形处理理能够尽量避开对具体设备坐标的考虑。实际图形处理时，先将世界坐标转换成对应的规格化设备坐标，然后再将规格化设备坐标映射到具体的设备坐标上去。</li>
<li><strong>屏幕坐标系统</strong> 也称设备坐标系统，它主要⽤于某⼀特殊的计算机图形显示设备(如光栅显示器)的表⾯的点的定义，在多数情况下，对于每一个具体的显示设备，都有一个单独的坐标系统，在定义了成像窗口的情况下，可进一步在屏幕坐标系统中定义称为视图区(view port)的有界区域，视图区中的成像即为实际所观察到的。</li>
</ul>

<h2 id="toc_15">参照</h2>

<p>简书 MissCC： <a href="https://www.jianshu.com/u/1b4c832fb2ca">简书 MissCC</a></p>

<ul>
<li>
<a href="#toc_0">一、基本图形硬件流水线设计</a>
</li>
<li>
<a href="#toc_1">二、渲染流水线的具体流程</a>
<ul>
<li>
<a href="#toc_2">1、应⽤层</a>
</li>
<li>
<a href="#toc_3">2、硬件抽象层</a>
</li>
<li>
<a href="#toc_4">3、硬件层</a>
</li>
</ul>
</li>
<li>
<a href="#toc_5">三、硬件层—固定渲染管线流程图</a>
</li>
<li>
<a href="#toc_6">四、硬件层—可编程渲染流水线流程图</a>
</li>
<li>
<a href="#toc_7">五、GPU 图形渲染管线</a>
<ul>
<li>
<a href="#toc_8">光栅化操作</a>
</li>
<li>
<a href="#toc_9">⼏何处理阶段</a>
</li>
</ul>
</li>
<li>
<a href="#toc_10">六、其他</a>
<ul>
<li>
<a href="#toc_11">Shader</a>
</li>
<li>
<a href="#toc_12">CPU 与 GPU 之间的关系</a>
</li>
<li>
<a href="#toc_13">三维坐标转变为二维屏幕坐标的过程</a>
</li>
<li>
<a href="#toc_14">坐标系详细概念</a>
</li>
</ul>
</li>
<li>
<a href="#toc_15">参照</a>
</li>
</ul>


		</div>
	</article>
	<div class="share-comment">
	 

	  

	  

	</div>
</div>        </div>
			<footer id="footer" class="inner">Copyright &copy; 2014
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a> &nbsp;&nbsp; 
Theme by <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a>
      </footer>
		</div>
	</div>

  
    



</body>
</html>